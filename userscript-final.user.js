"use strict";
// ==UserScript==
// @name         Neptun Órarend+
// @namespace    http://tampermonkey.net/
// @version      2024-02-01
// @description
// @author       You
// @match        https://neptun.uni-obuda.hu/hallgato/main.aspx?*ctrl=0303*
// @grant        GM_registerMenuCommand
// ==/UserScript==
const htmlCode = "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Órarend</title>\n\n    <!-- These tags are replaced by the JS and CSS files by `build.mjs` -->\n    <style>#timetable-column {\n  --row-gap: 0.05em;\n  --extra-width: 0.1em;\n  display: grid;\n  row-gap: var(--row-gap);\n  column-gap: 1em;\n  height: 90vh;\n}\n#timetable-column > div {\n  border: 1px solid black;\n  background-color: white;\n  z-index: 1;\n}\n#timetable-column .time-marker {\n  border: none;\n  padding: 0;\n}\n#timetable-column .time-marker {\n  background-color: transparent;\n}\n#timetable-column .time-marker > * {\n  /* move time (&) onto gridlines */\n  translate: 0 calc(-50% - var(--row-gap) / 2);\n  background-color: white;\n  padding: 0 5px;\n  border: 1px solid black;\n}\n#timetable-column .horizontal-line {\n  border: none;\n  border-top: calc(var(--extra-width) + var(--row-gap)) dashed gray;\n  translate: 0 calc(-1 * (var(--extra-width) / 2 + var(--row-gap)));\n  z-index: 0;\n  transition: border-color 1s;\n}\n#timetable-column .horizontal-line:hover {\n  border-color: red;\n}\n\n/*# sourceMappingURL=index.css.map */\n</style>\n    <script>\"use strict\";\nfunction time(hh, mm) {\n    return hh * 60 + mm;\n}\nfunction formatTime(t) {\n    return `${Math.floor(t / 60)}:${Math.floor(t % 60).toString().padStart(2, '0')}`;\n}\nfunction createMonogram(names) {\n    return names.split(',').map(n => n.split(' ').filter(n => !(/^dr(?!\\w)|^\\s*$/i.test(n))).map(n => n[0]).join('')).join(',');\n}\nfunction setPositionInGrid(elem, colStart, colEnd, rowStart, rowEnd) {\n    elem.style.gridColumnStart = String(colStart + 1);\n    elem.style.gridColumnEnd = String(colEnd + 1);\n    elem.style.gridRowStart = String(rowStart + 1);\n    elem.style.gridRowEnd = String(rowEnd + 1);\n}\nfunction createElement(grid) {\n    return grid.appendChild(document.createElement('div'));\n}\nfunction main() {\n    const testCoursesRaw = { \"Algoritmusok és adatszerkezetek * (NSXAA1HBNF)Mintatanterv:#NIK Mérnökinformatikus Nappali Bsc (F-tanterv)\": { \"LA01\": { \"metadata\": { \"\": \"LA01\", \"Kurzus kódja\": \"LA01\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"CS:14:25-16:05 (BA.1.15)\", \"Oktatók\": \"Gáspár Balázs\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"LA02\": { \"metadata\": { \"\": \"LA02\", \"Kurzus kódja\": \"LA02\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"15/0/24\", \"Órarend infó\": \"CS:16:15-17:50 (BA.1.15)\", \"Oktatók\": \"Gáspár Balázs\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"LA03\": { \"metadata\": { \"\": \"LA03\", \"Kurzus kódja\": \"LA03\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"SZE:09:50-11:30 (BA.2.14)\", \"Oktatók\": \"Egres Kata\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"LA04\": { \"metadata\": { \"\": \"LA04\", \"Kurzus kódja\": \"LA04\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"H:13:30-15:10 (BK.1.127)\", \"Oktatók\": \"Gáspár Balázs\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"LA05\": { \"metadata\": { \"\": \"LA05\", \"Kurzus kódja\": \"LA05\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"H:11:40-13:20 (BA.1.15)\", \"Oktatók\": \"Dr. Sergyán Szabolcs\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"LA06\": { \"metadata\": { \"\": \"LA06\", \"Kurzus kódja\": \"LA06\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"H:13:30-15:10 (BA.1.15)\", \"Oktatók\": \"Dr. Sergyán Szabolcs\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"LA07\": { \"metadata\": { \"\": \"LA07\", \"Kurzus kódja\": \"LA07\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"SZE:14:25-16:05 (BA.2.14)\", \"Oktatók\": \"Egres Kata\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"LA08\": { \"metadata\": { \"\": \"LA08\", \"Kurzus kódja\": \"LA08\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"SZE:16:15-17:50 (BA.2.14)\", \"Oktatók\": \"Egres Kata\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"LA09\": { \"metadata\": { \"\": \"LA09\", \"Kurzus kódja\": \"LA09\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"K:14:25-16:05 (BA.1.13)\", \"Oktatók\": \"Kovács Gábor\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": true }, \"LA10\": { \"metadata\": { \"\": \"LA10\", \"Kurzus kódja\": \"LA10\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"K:16:15-17:50 (BA.1.13)\", \"Oktatók\": \"Kovács Gábor\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"LA11\": { \"metadata\": { \"\": \"LA11\", \"Kurzus kódja\": \"LA11\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"0/0/0\", \"Órarend infó\": \"H:17:55-19:30 (BA.2.10)\", \"Oktatók\": \"Tusor Balázs\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"EA\": { \"metadata\": { \"\": \"EA\", \"Kurzus kódja\": \"EA\", \"Kurzus típusa\": \"Elmélet\", \"Fő/Várólista/Limit\": \"231/0/300\", \"Órarend infó\": \"H:08:00-10:35 (BA.1.32.Audmax)\", \"Oktatók\": \"Dr. Szénási Sándor\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": true } }, \"Haladó szoftverfejlesztés * (NSXHSFHBNF)Mintatanterv:#NIK Mérnökinformatikus Nappali Bsc (F-tanterv)\": { \"HSZF_EA\": { \"metadata\": { \"\": \"HSZF_EA\", \"Kurzus kódja\": \"HSZF_EA\", \"Kurzus típusa\": \"Elmélet\", \"Fő/Várólista/Limit\": \"326/0/336\", \"Órarend infó\": \"H:20:25-22:00\", \"Oktatók\": \"Molnár Attila, Dr. Vámossy Zoltán Imre\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": true }, \"HSZF_LA01\": { \"metadata\": { \"\": \"HSZF_LA01\", \"Kurzus kódja\": \"HSZF_LA01\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"SZE:08:00-11:30 (BA.1.14)\", \"Oktatók\": \"Molnár Attila\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"HSZF_LA02\": { \"metadata\": { \"\": \"HSZF_LA02\", \"Kurzus kódja\": \"HSZF_LA02\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"SZE:08:00-11:30 (BA.1.14)\", \"Oktatók\": \"Molnár Attila\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"HSZF_LA03\": { \"metadata\": { \"\": \"HSZF_LA03\", \"Kurzus kódja\": \"HSZF_LA03\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"H:14:25-17:50 (BA.1.13)\", \"Oktatók\": \"Dr. Simon-Nagy Gábor\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"HSZF_LA04\": { \"metadata\": { \"\": \"HSZF_LA04\", \"Kurzus kódja\": \"HSZF_LA04\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"H:14:25-17:50 (BA.1.13)\", \"Oktatók\": \"Dr. Simon-Nagy Gábor\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"HSZF_LA05\": { \"metadata\": { \"\": \"HSZF_LA05\", \"Kurzus kódja\": \"HSZF_LA05\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"CS:09:50-13:20 (BA.2.14)\", \"Oktatók\": \"Egres Kata\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": true }, \"HSZF_LA06\": { \"metadata\": { \"\": \"HSZF_LA06\", \"Kurzus kódja\": \"HSZF_LA06\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"CS:09:50-13:20 (BA.2.14)\", \"Oktatók\": \"Egres Kata\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"HSZF_LA07\": { \"metadata\": { \"\": \"HSZF_LA07\", \"Kurzus kódja\": \"HSZF_LA07\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"CS:15:20-18:40 (BA.1.13)\", \"Oktatók\": \"Haydu Lénárt\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"HSZF_LA08\": { \"metadata\": { \"\": \"HSZF_LA08\", \"Kurzus kódja\": \"HSZF_LA08\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"14/0/24\", \"Órarend infó\": \"CS:15:20-18:40 (BA.1.13)\", \"Oktatók\": \"Molnár Attila\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"HSZF_LA09\": { \"metadata\": { \"\": \"HSZF_LA09\", \"Kurzus kódja\": \"HSZF_LA09\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"SZE:08:55-12:25 (BA.1.15)\", \"Oktatók\": \"Mikhel Roland\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"HSZF_LA10\": { \"metadata\": { \"\": \"HSZF_LA10\", \"Kurzus kódja\": \"HSZF_LA10\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"SZE:08:55-12:25 (BA.1.15)\", \"Oktatók\": \"Mikhel Roland\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"HSZF_LA11\": { \"metadata\": { \"\": \"HSZF_LA11\", \"Kurzus kódja\": \"HSZF_LA11\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"0/0/0\", \"Órarend infó\": \"\", \"Oktatók\": \"\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false } }, \"Számítógép hálózatok (NKXSH1HBNF)Mintatanterv:#NIK Mérnökinformatikus Nappali Bsc (F-tanterv)\": { \"SzGH_EA\": { \"metadata\": { \"\": \"SzGH_EA\", \"Kurzus kódja\": \"SzGH_EA\", \"Kurzus típusa\": \"Elmélet\", \"Fő/Várólista/Limit\": \"318/0/336\", \"Órarend infó\": \"SZE:12:35-14:15 (BA.1.32.Audmax)\", \"Oktatók\": \"Zaletnyik Péter Tibor\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": true }, \"SzGH_LA_01\": { \"metadata\": { \"\": \"SzGH_LA_01\", \"Kurzus kódja\": \"SzGH_LA_01\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"H:10:45-12:25 (BA.2.14)\", \"Oktatók\": \"Légrádi Gábor\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"SzGH_LA_02\": { \"metadata\": { \"\": \"SzGH_LA_02\", \"Kurzus kódja\": \"SzGH_LA_02\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"H:12:35-14:15 (BA.2.14)\", \"Oktatók\": \"Légrádi Gábor\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"SzGH_LA_03\": { \"metadata\": { \"\": \"SzGH_LA_03\", \"Kurzus kódja\": \"SzGH_LA_03\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"H:14:25-16:05 (BA.2.14)\", \"Oktatók\": \"Légrádi Gábor\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"SzGH_LA_04\": { \"metadata\": { \"\": \"SzGH_LA_04\", \"Kurzus kódja\": \"SzGH_LA_04\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"CS:09:50-11:30 (BA.1.14)\", \"Oktatók\": \"Légrádi Gábor\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"SzGH_LA_05\": { \"metadata\": { \"\": \"SzGH_LA_05\", \"Kurzus kódja\": \"SzGH_LA_05\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"CS:11:40-13:20 (BA.1.14)\", \"Oktatók\": \"Légrádi Gábor\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"SzGH_LA_06\": { \"metadata\": { \"\": \"SzGH_LA_06\", \"Kurzus kódja\": \"SzGH_LA_06\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"CS:13:30-15:10 (BA.1.14)\", \"Oktatók\": \"Légrádi Gábor\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"SzGH_LA_07\": { \"metadata\": { \"\": \"SzGH_LA_07\", \"Kurzus kódja\": \"SzGH_LA_07\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"CS:17:05-18:40 (BA.1.14)\", \"Oktatók\": \"Szabó Patrik László\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": true }, \"SzGH_LA_08\": { \"metadata\": { \"\": \"SzGH_LA_08\", \"Kurzus kódja\": \"SzGH_LA_08\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"CS:08:00-09:40 (BA.1.14)\", \"Oktatók\": \"Zaletnyik Péter Tibor\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"Csizmadia Gábor demo kurzus\", \"Leírás\": \"\" }, \"checked\": false }, \"SzGH_LA_09\": { \"metadata\": { \"\": \"SzGH_LA_09\", \"Kurzus kódja\": \"SzGH_LA_09\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"SZE:14:25-16:05 (BA.1.15)\", \"Oktatók\": \"Zaletnyik Péter Tibor\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"Gazdag Dominika demo kurzus\", \"Leírás\": \"\" }, \"checked\": false }, \"SzGH_LA_10\": { \"metadata\": { \"\": \"SzGH_LA_10\", \"Kurzus kódja\": \"SzGH_LA_10\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"K:08:55-10:35 (BA.2.14)\", \"Oktatók\": \"Zaletnyik Péter Tibor\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"Vaszkó Attila demo kurzus\", \"Leírás\": \"\" }, \"checked\": false }, \"SzGH_LA_11\": { \"metadata\": { \"\": \"SzGH_LA_11\", \"Kurzus kódja\": \"SzGH_LA_11\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"K:14:25-16:05 (BA.1.15)\", \"Oktatók\": \"Zaletnyik Péter Tibor\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"Miskolczi Richárd demo kurzus\", \"Leírás\": \"\" }, \"checked\": false }, \"SzGH_LA_12\": { \"metadata\": { \"\": \"SzGH_LA_12\", \"Kurzus kódja\": \"SzGH_LA_12\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"K:18:45-20:20 (BA.1.15)\", \"Oktatók\": \"Zaletnyik Péter Tibor\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"Bod Gergely demo kurzus\", \"Leírás\": \"\" }, \"checked\": false }, \"SzGH_LA_13\": { \"metadata\": { \"\": \"SzGH_LA_13\", \"Kurzus kódja\": \"SzGH_LA_13\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"SZE:08:15-09:40 (BA.2.14)\", \"Oktatók\": \"Zaletnyik Péter Tibor\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"Petkó Csaba demo kurzus\", \"Leírás\": \"\" }, \"checked\": false }, \"SzH_ÜM_LA_02\": { \"metadata\": { \"\": \"SzH_ÜM_LA_02\", \"Kurzus kódja\": \"SzH_ÜM_LA_02\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"SZE:17:05-18:40 (BA.1.13)\", \"Oktatók\": \"Szabó Patrik László\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"Horváth Zsombor demo kurzus\", \"Leírás\": \"\" }, \"checked\": false }, \"SzH_ÜM_LA_03\": { \"metadata\": { \"\": \"SzH_ÜM_LA_03\", \"Kurzus kódja\": \"SzH_ÜM_LA_03\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"5/0/24\", \"Órarend infó\": \"SZE:18:45-20:20 (BA.1.13)\", \"Oktatók\": \"Szabó Patrik László\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"Horváth Zsombor demo kurzus\", \"Leírás\": \"Csak Szoftver specializációs hallgatóknak!\" }, \"checked\": false }, \"SzGH_SLG_EA\": { \"metadata\": { \"\": \"SzGH_SLG_EA\", \"Kurzus kódja\": \"SzGH_SLG_EA\", \"Kurzus típusa\": \"Elmélet\", \"Fő/Várólista/Limit\": \"0/0/24\", \"Órarend infó\": \"\", \"Oktatók\": \"\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"Horváth Zsombor demo kurzus\", \"Leírás\": \"\" }, \"checked\": false }, \"SzGH_SLG_LA\": { \"metadata\": { \"\": \"SzGH_SLG_LA\", \"Kurzus kódja\": \"SzGH_SLG_LA\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"0/0/24\", \"Órarend infó\": \"\", \"Oktatók\": \"\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"Horváth Zsombor demo kurzus\", \"Leírás\": \"\" }, \"checked\": false }, \"SzGH_LA_14\": { \"metadata\": { \"\": \"SzGH_LA_14\", \"Kurzus kódja\": \"SzGH_LA_14\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"1/0/10\", \"Órarend infó\": \"\", \"Oktatók\": \"\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false } }, \"Analízis II. (NMXAN2HBNF)Mintatanterv:#NIK Mérnökinformatikus Nappali Bsc (F-tanterv)\": { \"ANAL_EA\": { \"metadata\": { \"\": \"ANAL_EA\", \"Kurzus kódja\": \"ANAL_EA\", \"Kurzus típusa\": \"Elmélet\", \"Fő/Várólista/Limit\": \"229/0/300\", \"Órarend infó\": \"K:12:35-14:15 (BA.1.32.Audmax)\", \"Oktatók\": \"Dr. Vajda István\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": true }, \"ANAL_GY_01\": { \"metadata\": { \"\": \"ANAL_GY_01\", \"Kurzus kódja\": \"ANAL_GY_01\", \"Kurzus típusa\": \"Gyakorlat\", \"Fő/Várólista/Limit\": \"25/0/25\", \"Órarend infó\": \"K:14:25-16:05 (BA.F.06)\", \"Oktatók\": \"Dr. Vajda István\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"ANAL_GY_02\": { \"metadata\": { \"\": \"ANAL_GY_02\", \"Kurzus kódja\": \"ANAL_GY_02\", \"Kurzus típusa\": \"Gyakorlat\", \"Fő/Várólista/Limit\": \"25/0/25\", \"Órarend infó\": \"CS:10:45-12:25 (BC.4.401)\", \"Oktatók\": \"Dr. György Anna\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"ANAL_GY_03\": { \"metadata\": { \"\": \"ANAL_GY_03\", \"Kurzus kódja\": \"ANAL_GY_03\", \"Kurzus típusa\": \"Gyakorlat\", \"Fő/Várólista/Limit\": \"25/0/25\", \"Órarend infó\": \"P:08:55-10:35 (BA.F.07)\", \"Oktatók\": \"Berta Gábor\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"ANAL_GY_04\": { \"metadata\": { \"\": \"ANAL_GY_04\", \"Kurzus kódja\": \"ANAL_GY_04\", \"Kurzus típusa\": \"Gyakorlat\", \"Fő/Várólista/Limit\": \"25/0/25\", \"Órarend infó\": \"P:10:45-12:25 (BA.F.07)\", \"Oktatók\": \"Berta Gábor\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": true }, \"ANAL_GY_05\": { \"metadata\": { \"\": \"ANAL_GY_05\", \"Kurzus kódja\": \"ANAL_GY_05\", \"Kurzus típusa\": \"Gyakorlat\", \"Fő/Várólista/Limit\": \"25/0/25\", \"Órarend infó\": \"H:11:40-13:20 (BA.F.07)\", \"Oktatók\": \"Hegedüs Gábor\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"ANAL_GY_06\": { \"metadata\": { \"\": \"ANAL_GY_06\", \"Kurzus kódja\": \"ANAL_GY_06\", \"Kurzus típusa\": \"Gyakorlat\", \"Fő/Várólista/Limit\": \"15/0/25\", \"Órarend infó\": \"K:15:20-17:00 (BA.F.07)\", \"Oktatók\": \"Hegedüs Gábor\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"ANAL_GY_07\": { \"metadata\": { \"\": \"ANAL_GY_07\", \"Kurzus kódja\": \"ANAL_GY_07\", \"Kurzus típusa\": \"Gyakorlat\", \"Fő/Várólista/Limit\": \"26/0/26\", \"Órarend infó\": \"K:08:00-09:40 (BA.F.07)\", \"Oktatók\": \"Záborszky Ágnes Zsuzsanna\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"Ez a kurzus nem indul!\": { \"metadata\": { \"\": \"Ez a kurzus nem indul!\", \"Kurzus kódja\": \"Ez a kurzus nem indul!\", \"Kurzus típusa\": \"Ez a kurzus nem indul!\", \"Fő/Várólista/Limit\": \"Ez a kurzus nem indul!\", \"Órarend infó\": \"Ez a kurzus nem indul!\", \"Oktatók\": \"Ez a kurzus nem indul!\", \"Nyelv\": \"Ez a kurzus nem indul!\", \"Telephely\": \"Ez a kurzus nem indul!\", \"Megj.\": \"\", \"Leírás\": \"Ez a kurzus nem indul!\" }, \"checked\": false }, \"ANAL_GY_09\": { \"metadata\": { \"\": \"ANAL_GY_09\", \"Kurzus kódja\": \"ANAL_GY_09\", \"Kurzus típusa\": \"Gyakorlat\", \"Fő/Várólista/Limit\": \"25/0/25\", \"Órarend infó\": \"CS:15:20-17:00 (BA.F.04)\", \"Oktatók\": \"Dr. Cserjés Ágota Rita\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"ANAL_GY_10\": { \"metadata\": { \"\": \"ANAL_GY_10\", \"Kurzus kódja\": \"ANAL_GY_10\", \"Kurzus típusa\": \"Gyakorlat\", \"Fő/Várólista/Limit\": \"26/0/26\", \"Órarend infó\": \"H:10:45-12:25 (BC.4.403)\", \"Oktatók\": \"Szabó László Attila\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"A kurzusra a jelentkezés letiltásra került.\": { \"metadata\": { \"\": \"A kurzusra a jelentkezés letiltásra került.\", \"Kurzus kódja\": \"A kurzusra a jelentkezés letiltásra került.\", \"Kurzus típusa\": \"A kurzusra a jelentkezés letiltásra került.\", \"Fő/Várólista/Limit\": \"A kurzusra a jelentkezés letiltásra került.\", \"Órarend infó\": \"A kurzusra a jelentkezés letiltásra került.\", \"Oktatók\": \"A kurzusra a jelentkezés letiltásra került.\", \"Nyelv\": \"A kurzusra a jelentkezés letiltásra került.\", \"Telephely\": \"A kurzusra a jelentkezés letiltásra került.\", \"Megj.\": \"\", \"Leírás\": \"A kurzusra a jelentkezés letiltásra került.\" }, \"checked\": false } }, \"Tutorálás (NBXTUTHBNF)Mintatanterv:#NIK Mérnökinformatikus Nappali Bsc (F-tanterv)\": { \"Ez a kurzus nem indul!\": { \"metadata\": { \"\": \"Ez a kurzus nem indul!\", \"Kurzus kódja\": \"Ez a kurzus nem indul!\", \"Kurzus típusa\": \"Ez a kurzus nem indul!\", \"Fő/Várólista/Limit\": \"Ez a kurzus nem indul!\", \"Órarend infó\": \"Ez a kurzus nem indul!\", \"Oktatók\": \"Ez a kurzus nem indul!\", \"Nyelv\": \"Ez a kurzus nem indul!\", \"Telephely\": \"Ez a kurzus nem indul!\", \"Megj.\": \"\", \"Leírás\": \"Ez a kurzus nem indul!\" }, \"checked\": false }, \"TU_GY_01_Lifecoach\": { \"metadata\": { \"\": \"TU_GY_01_Lifecoach\", \"Kurzus kódja\": \"TU_GY_01_Lifecoach\", \"Kurzus típusa\": \"Gyakorlat\", \"Fő/Várólista/Limit\": \"56/0/150\", \"Órarend infó\": \"\", \"Oktatók\": \"Lazányi Kornélia Rozália\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"TU_GY_02_Demonstrátor\": { \"metadata\": { \"\": \"TU_GY_02_Demonstrátor\", \"Kurzus kódja\": \"TU_GY_02_Demonstrátor\", \"Kurzus típusa\": \"Gyakorlat\", \"Fő/Várólista/Limit\": \"25/0/30\", \"Órarend infó\": \"\", \"Oktatók\": \"Zaletnyik Péter Tibor\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": true }, \"TU_GY_03_Projekt\": { \"metadata\": { \"\": \"TU_GY_03_Projekt\", \"Kurzus kódja\": \"TU_GY_03_Projekt\", \"Kurzus típusa\": \"Gyakorlat\", \"Fő/Várólista/Limit\": \"38/0/200\", \"Órarend infó\": \"\", \"Oktatók\": \"Tafferner-Gulyás Viktória\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"TU_GY_04_Csop.vez\": { \"metadata\": { \"\": \"TU_GY_04_Csop.vez\", \"Kurzus kódja\": \"TU_GY_04_Csop.vez\", \"Kurzus típusa\": \"Gyakorlat\", \"Fő/Várólista/Limit\": \"23/0/100\", \"Órarend infó\": \"\", \"Oktatók\": \"Lazányi Kornélia Rozália\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false } }, \"Fizika (KTXFIBHBNF)Mintatanterv:#NIK Mérnökinformatikus Nappali Bsc (F-tanterv)\": { \"Fiz_EA\": { \"metadata\": { \"\": \"Fiz_EA\", \"Kurzus kódja\": \"Fiz_EA\", \"Kurzus típusa\": \"E-Learning\", \"Fő/Várólista/Limit\": \"203/0/236\", \"Órarend infó\": \"CS:17:55-19:30 (BA.1.32.Audmax)\", \"Oktatók\": \"Dr. Rácz Ervin, Dr. Bencze Attila István\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": true }, \"Fiz_Gy_01\": { \"metadata\": { \"\": \"Fiz_Gy_01\", \"Kurzus kódja\": \"Fiz_Gy_01\", \"Kurzus típusa\": \"Gyakorlat\", \"Fő/Várólista/Limit\": \"48/0/48\", \"Órarend infó\": \"\", \"Oktatók\": \"Dr. Bencze Attila István\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"Fiz_Gy_02\": { \"metadata\": { \"\": \"Fiz_Gy_02\", \"Kurzus kódja\": \"Fiz_Gy_02\", \"Kurzus típusa\": \"Gyakorlat\", \"Fő/Várólista/Limit\": \"48/0/48\", \"Órarend infó\": \"\", \"Oktatók\": \"Dr. Bencze Attila István\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": true }, \"Fiz_Gy_03\": { \"metadata\": { \"\": \"Fiz_Gy_03\", \"Kurzus kódja\": \"Fiz_Gy_03\", \"Kurzus típusa\": \"Gyakorlat\", \"Fő/Várólista/Limit\": \"37/0/70\", \"Órarend infó\": \"\", \"Oktatók\": \"Dr. Bencze Attila István\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"Fiz_Gy_04\": { \"metadata\": { \"\": \"Fiz_Gy_04\", \"Kurzus kódja\": \"Fiz_Gy_04\", \"Kurzus típusa\": \"Gyakorlat\", \"Fő/Várólista/Limit\": \"70/0/70\", \"Órarend infó\": \"\", \"Oktatók\": \"Dr. Bencze Attila István\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false } }, \"Digitális rendszerek (NKXDR1HBNF)Mintatanterv:#NIK Mérnökinformatikus Nappali Bsc (F-tanterv)\": { \"DR1_EA\": { \"metadata\": { \"\": \"DR1_EA\", \"Kurzus kódja\": \"DR1_EA\", \"Kurzus típusa\": \"Elmélet\", \"Fő/Várólista/Limit\": \"288/0/312\", \"Órarend infó\": \"K:10:45-12:25 (BA.1.32.Audmax)\", \"Oktatók\": \"Dr. Komoróczki-Steiner Henriette\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": true }, \"DR1_LA_01\": { \"metadata\": { \"\": \"DR1_LA_01\", \"Kurzus kódja\": \"DR1_LA_01\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"23/0/24\", \"Órarend infó\": \"H:10:45-12:25 (BA.2.18)\", \"Oktatók\": \"Dr. Komoróczki-Steiner Henriette\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"DR1_LA_02\": { \"metadata\": { \"\": \"DR1_LA_02\", \"Kurzus kódja\": \"DR1_LA_02\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"19/0/24\", \"Órarend infó\": \"H:12:35-14:15 (BA.2.18)\", \"Oktatók\": \"Dr. Komoróczki-Steiner Henriette\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"DR1_LA_03\": { \"metadata\": { \"\": \"DR1_LA_03\", \"Kurzus kódja\": \"DR1_LA_03\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"K:08:55-10:35 (BA.2.18)\", \"Oktatók\": \"Dr. Komoróczki-Steiner Henriette\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"DR1_LA_04\": { \"metadata\": { \"\": \"DR1_LA_04\", \"Kurzus kódja\": \"DR1_LA_04\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"6/0/24\", \"Órarend infó\": \"H:16:15-17:50 (BA.2.18)\", \"Oktatók\": \"Dr. Komoróczki-Steiner Henriette\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"DR1_LA_05\": { \"metadata\": { \"\": \"DR1_LA_05\", \"Kurzus kódja\": \"DR1_LA_05\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"CS:08:00-09:40 (BA.2.18)\", \"Oktatók\": \"Zakár István\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"DR1_LA_06\": { \"metadata\": { \"\": \"DR1_LA_06\", \"Kurzus kódja\": \"DR1_LA_06\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"CS:09:50-11:30 (BA.2.18)\", \"Oktatók\": \"Zakár István\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"DR1_LA_07\": { \"metadata\": { \"\": \"DR1_LA_07\", \"Kurzus kódja\": \"DR1_LA_07\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"K:14:25-16:05 (BA.2.18)\", \"Oktatók\": \"Somlyai László\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"DR1_LA_08\": { \"metadata\": { \"\": \"DR1_LA_08\", \"Kurzus kódja\": \"DR1_LA_08\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"K:16:15-17:50 (BA.2.18)\", \"Oktatók\": \"Somlyai László\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"DR1_LA_09\": { \"metadata\": { \"\": \"DR1_LA_09\", \"Kurzus kódja\": \"DR1_LA_09\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"K:17:55-19:30 (BA.2.18)\", \"Oktatók\": \"Somlyai László\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"DR1_LA_10\": { \"metadata\": { \"\": \"DR1_LA_10\", \"Kurzus kódja\": \"DR1_LA_10\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"CS:11:40-13:20 (BA.2.18)\", \"Oktatók\": \"Somlyai László\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"DR1_LA_11\": { \"metadata\": { \"\": \"DR1_LA_11\", \"Kurzus kódja\": \"DR1_LA_11\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"CS:13:30-15:10 (BA.2.18)\", \"Oktatók\": \"Somlyai László\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"DR1_LA_12\": { \"metadata\": { \"\": \"DR1_LA_12\", \"Kurzus kódja\": \"DR1_LA_12\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"CS:15:20-17:00 (BA.2.18)\", \"Oktatók\": \"Somlyai László\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"DR1_LA_13\": { \"metadata\": { \"\": \"DR1_LA_13\", \"Kurzus kódja\": \"DR1_LA_13\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"24/0/24\", \"Órarend infó\": \"P:12:35-14:15 (BA.2.18)\", \"Oktatók\": \"Zakár István\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": true }, \"DR1_EA_SLG\": { \"metadata\": { \"\": \"DR1_EA_SLG\", \"Kurzus kódja\": \"DR1_EA_SLG\", \"Kurzus típusa\": \"Elmélet\", \"Fő/Várólista/Limit\": \"0/0/24\", \"Órarend infó\": \"\", \"Oktatók\": \"Dr. Komoróczki-Steiner Henriette\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false }, \"DR1_LA_SLG\": { \"metadata\": { \"\": \"DR1_LA_SLG\", \"Kurzus kódja\": \"DR1_LA_SLG\", \"Kurzus típusa\": \"Labor\", \"Fő/Várólista/Limit\": \"0/0/24\", \"Órarend infó\": \"\", \"Oktatók\": \"Fekete György\", \"Nyelv\": \"magyar\", \"Telephely\": \"\", \"Megj.\": \"\", \"Leírás\": \"\" }, \"checked\": false } } };\n    const windowCourses = (history.state /*as { courses?: Record<string, Record<string, {checked: boolean, metadata: Record<string, string>}>> }*/);\n    if (!windowCourses) {\n        console.warn('Using test course data');\n    }\n    const coursesRaw = windowCourses || testCoursesRaw;\n    const courses = [];\n    for (const [subject, coursesObj] of Object.entries(coursesRaw)) {\n        for (const [courseCode, properties] of Object.entries(coursesObj)) {\n            const timetableInfo = properties.metadata[\"Órarend infó\"];\n            const match = timetableInfo.match(/^(\\w+):(\\d+:\\d+)-(\\d+:\\d+)/);\n            if (!match) {\n                continue;\n            }\n            const [, day, startString, endString] = match;\n            const startTime = time(...startString.split(':').map(Number));\n            const endTime = time(...endString.split(':').map(Number));\n            courses.push({\n                start: startTime,\n                end: endTime,\n                properties: {\n                    Nap: day,\n                    subject,\n                    Tárgy: subject.match(/^[\\w\\s]*/)?.[0] || subject,\n                    checked: properties.checked,\n                    code: courseCode,\n                    ...properties.metadata\n                }\n            });\n        }\n    }\n    const grid = document.querySelector('#timetable-column');\n    renderTimetableGrid(grid, courses, [\n        {\n            group(courses) {\n                const out = ['Hétfő', 'Kedd', 'Szerda', 'Csütörtök', 'Péntek', 'Szombat', 'Vasárnap'].map(n => ({\n                    header: n,\n                    courses: []\n                }));\n                const days = ['H', 'K', 'SZE', 'CS', 'P', 'SZO', 'V'];\n                for (const course of courses) {\n                    const idx = days.indexOf(String(course.properties.Nap));\n                    if (idx === -1) {\n                        continue;\n                    }\n                    out[idx].courses.push(course);\n                }\n                return out;\n            },\n        }\n    ]);\n}\ndocument.addEventListener('DOMContentLoaded', main);\nfunction renderTimetableGrid(grid, courses, groupByKeys) {\n    const timeMap = createTimeMap(courses);\n    const templateRowHeights = renderTimeMarkerColumn(grid, timeMap, groupByKeys.length);\n    const headerTemplateRowHeights = groupByKeys.map(() => 'min-content').join(' ');\n    grid.style.gridTemplateRows = `${headerTemplateRowHeights} ${templateRowHeights}`;\n    const [width, templateColWidths] = renderCoursesWithHeader(grid, courses, groupByKeys, timeMap, 1, 0);\n    renderHorizontalLines(grid, timeMap.size, 0, width + 1, groupByKeys.length);\n    grid.style.gridTemplateColumns = ['fit-content(1fr)', templateColWidths].join(' ');\n    function assignToLanes(courses) {\n        courses.sort((a, b) => a.start - b.start);\n        let lanes = 0;\n        const freeLanes = new Set;\n        const endsOfOngoing = [];\n        const laneMap = new WeakMap;\n        for (const course of courses) {\n            while (endsOfOngoing.length > 0 && endsOfOngoing.at(-1).end <= course.start) {\n                const popped = endsOfOngoing.pop();\n                freeLanes.add(laneMap.get(popped));\n            }\n            if (freeLanes.size === 0) {\n                freeLanes.add(lanes++);\n            }\n            const lane = freeLanes.keys().next().value;\n            freeLanes.delete(lane);\n            laneMap.set(course, lane);\n            const binarySearch = (arr, target) => {\n                let start = 0;\n                let end = arr.length;\n                while (start < end) {\n                    const middle = Math.floor((start + end) / 2);\n                    if (arr[middle].end > target) {\n                        start = middle + 1;\n                    }\n                    else {\n                        end = middle;\n                    }\n                }\n                return start;\n            };\n            const index = binarySearch(endsOfOngoing, course.end);\n            endsOfOngoing.splice(index, 0, course);\n        }\n        ;\n        return [lanes, laneMap];\n    }\n    function createTimeMap(courses) {\n        const times = new Set;\n        for (const course of courses) {\n            times.add(course.start);\n            times.add(course.end);\n        }\n        const timesSorted = [...times].sort((a, b) => a - b);\n        const timeMap = new Map();\n        for (let i = 0; i < timesSorted.length; i++) {\n            timeMap.set(timesSorted[i], i);\n        }\n        return timeMap;\n    }\n    function renderCourseGroup(grid, courses, timeMap, laneMap, colOffset, rowOffset) {\n        const colWidths = [];\n        for (let i = 0; i < courses.length; i++) {\n            const course = courses[i];\n            const elem = document.createElement('div');\n            elem.textContent = createMonogram(String(course.properties.Oktatók));\n            elem.classList.add('course');\n            setCoursePositionInGrid(elem, course, timeMap, laneMap, colOffset, rowOffset);\n            grid.append(elem);\n            colWidths.push('fit-content(1fr)');\n        }\n        return colWidths.join(' ');\n    }\n    function setCoursePositionInGrid(elem, course, timeMap, laneMap, colOffset, rowOffset) {\n        const lane = laneMap.get(course);\n        if (lane === undefined) {\n            throw new Error('lane not assigned to course in `setCoursePositionInGrid`');\n        }\n        setPositionInGrid(elem, colOffset + lane, colOffset + lane + 1, rowOffset + timeMap.get(course.start), rowOffset + timeMap.get(course.end));\n    }\n    function renderCoursesWithHeader(grid, courses, groupByKeys, timeMap, startColumn, startRow) {\n        if (groupByKeys.length === 0) {\n            const [laneCount, laneMap] = assignToLanes(courses);\n            const templateColWidths = renderCourseGroup(grid, courses, timeMap, laneMap, startColumn, startRow);\n            return [laneCount, templateColWidths];\n        }\n        else {\n            const [key, ...newGroupByKeys] = groupByKeys;\n            const groups = key.group(courses);\n            let columns = 0;\n            const templateColWidths = [];\n            for (const { header, courses: group } of groups) {\n                const groupMarker = createElement(grid);\n                groupMarker.innerText = header;\n                groupMarker.classList.add('header-marker');\n                const [width, curTemplateColWidths] = renderCoursesWithHeader(grid, group, newGroupByKeys, timeMap, startColumn + columns, startRow + 1);\n                const realWidth = Math.max(width, 1);\n                templateColWidths.push(curTemplateColWidths);\n                setPositionInGrid(groupMarker, startColumn + columns, startColumn + columns + realWidth, startRow, startRow + 1);\n                columns += realWidth;\n            }\n            return [columns, templateColWidths.join(' ')];\n        }\n    }\n    /**\n     * @returns string of CSS `grid-template-rows` row heights\n     */\n    function renderTimeMarkerColumn(grid, timeMap, startRow) {\n        const timeIter = timeMap.entries();\n        const { done, value: firstEntry } = timeIter.next();\n        if (done) {\n            throw new Error('No items in the timetable');\n        }\n        function addTimeMarkerElem(time) {\n            const timeMarker = createElement(grid);\n            setPositionInGrid(timeMarker, 0, 1, startRow + time[1], startRow + time[1] + 1);\n            timeMarker.classList.add('time-marker');\n            const timeMarkerInner = timeMarker.appendChild(document.createElement('div'));\n            timeMarkerInner.innerText = formatTime(time[0]);\n        }\n        addTimeMarkerElem(firstEntry);\n        //this relies on the fact that `timeMap` is sorted by time\n        let prevTime = firstEntry;\n        const lengths = [];\n        for (const time of timeIter) {\n            lengths.push(String(time[0] - prevTime[0]) + 'fr');\n            addTimeMarkerElem(time);\n            prevTime = time;\n        }\n        return lengths.join(' ');\n    }\n    /*\n        function groupCourses(courses: Course[], key: string): Map<unknown, Course[]> {\n            return Map.groupBy(courses, course => course.properties[key]);\n        }*/\n    function renderHorizontalLines(grid, lineCount, startColumn, endColumn, startRow) {\n        for (let i = 0; i < lineCount; i++) {\n            const horizontalLine = createElement(grid);\n            setPositionInGrid(horizontalLine, startColumn, endColumn, startRow + i, startRow + i + 1);\n            horizontalLine.classList.add('horizontal-line');\n        }\n    }\n}\n</script>\n\n</head>\n<body>\n    <div id=\"timetable-column\">\n\n    </div>\n</body>\n</html>"; //This call is replaced by a string literal of the bundled HTML file by `build.mjs`
const htmlUrl = URL.createObjectURL(new Blob([htmlCode]));
(function () {
    'use strict';
    const localStorageKey = 'neptun-orarend-plus-data';
    GM_registerMenuCommand('Órarend megnyitása', openTimetable);
    function openTimetable() {
        const childWindow = window.open(htmlUrl, '_blank');
        if (!childWindow) {
            alert('Popup blocked');
            return;
        }
        const courses = JSON.parse(localStorage.getItem(localStorageKey) || '{}');
        console.log(courses);
        //(childWindow as Window & { courses: unknown }).courses = courses;
        childWindow.history.replaceState(courses, '');
        childWindow.document.close();
    }
    let lastSubject = null;
    const update = (forceRefresh = false) => {
        const tabElement = document.querySelector('#Subject_data_for_schedule_tab_body');
        if (!tabElement)
            return;
        const subject = tabElement.querySelector('h2').textContent;
        if (subject === lastSubject && !forceRefresh)
            return;
        lastSubject = subject;
        console.log('Refreshing data for subject %s', subject);
        const coursesTable = tabElement.querySelector('table.table_body');
        const data = JSON.parse(window.localStorage.getItem(localStorageKey) || '{}');
        const currentSubjectData = data[subject] ??= {};
        const coursesTableHeaders = Array.from(coursesTable.querySelectorAll('th'), e => e.textContent);
        for (const courseRow of coursesTable.querySelectorAll('tbody>tr')) {
            const currentCourseMetaData = {};
            const courseRowCells = courseRow.querySelectorAll('td');
            for (let i = 0; i < coursesTableHeaders.length; i++) {
                currentCourseMetaData[coursesTableHeaders[i]] = courseRowCells[i].querySelector('.tooltipDetails')?.innerText ?? courseRowCells[i].innerText;
            }
            const checkbox = courseRow.querySelector('input[type="checkbox"]');
            currentSubjectData[currentCourseMetaData['Kurzus kódja']] = {
                metadata: currentCourseMetaData,
                checked: checkbox.checked
            };
        }
        window.localStorage.setItem(localStorageKey, JSON.stringify(data));
    };
    setInterval(update, 500, false);
})();
